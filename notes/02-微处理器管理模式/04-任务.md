## 任务

### 任务切换的四种情况

1. 执行远程JMP或者CALL指令，选择了GDT中的TSS描述符。
2. 执行远程JMP或者CALL指令，从GDT或者LDT中选择了任务门。
3. 发生了中断或异常，中断向量选择了IDT中的任务门。
4. 当FLAGs中的NT=1时，执行IRET指令，目的任务选择符在执行IRET任务的TSS链接域中。

### 任务状态段TSS

- 也放在GDT中
- 在多任务的环境下，每个任务都有属于自己的任务状态段TSS
- 任务状态段TSS在存储器的基地址和限长由TSS描述符指出
- TR寄存器中存放的是当前任务的TSS描述符的选择符

<div>
<table>
    <tr>
        <td>+0</td>
        <td colspan="8" align=center>限长 (位7~0)</td>
    </tr>
    <tr>
        <td>+1</td>
        <td colspan="8" align=center>限长 (位15~8)</td>
    </tr>
    <tr>
        <td>+2</td>
        <td colspan="8" align=center>段基址 (位7~0)</td>
    </tr>
    <tr>
        <td>+3</td>
        <td colspan="8" align=center>段基址 (位15~8)</td>
    </tr>
    <tr>
        <td>+4</td>
        <td colspan="8" align=center>段基址 (位23~16)</td>
    </tr>
    <tr>
        <td>+5</td>
        <td colspan="1" align=center> P </td>
        <td colspan="2" align=center> DPL </td>
        <td colspan="1" align=center> S=0 </td>
        <td colspan="1" align=center> 1 </td>
        <td colspan="1" align=center> 0 </td>
        <td colspan="1" align=center> B </td>
        <td colspan="1" align=center> 1 </td>
    </tr>
    <tr>
        <td>+6</td>
        <td colspan="1" align=center> G </td>
        <td colspan="1" align=center> 0 </td>
        <td colspan="1" align=center> 0 </td>
        <td colspan="1" align=center> AVL </td>
        <td colspan="4" align=center> 限长 (位19~16)</td>
    </tr>
    <tr>
        <td>+7</td>
        <td colspan="8" align=center>段基址 (位31~24)</td>
    </tr>
</table>
</div>

- B=0表示386的可用的任务状态段
- B=1表示386的忙碌任务状态段


### 门

（系统描述符；调用门；任务门）

门的类型有四种

- **调用门** ：用于控制传送，来改变任务或程序的特权级别。
  - 从低特权级变换到高特权级
- **任务门** ：执行任务切换。
  - 门中的偏移无意义
- **中断门和陷阱门** ：用来指出中断服务程序的入口地址。
  - 中断门和陷阱门内的选择符必须指向代码段描述符，门内的偏移就是对应代码段的入口点的偏移

还有门描述符
