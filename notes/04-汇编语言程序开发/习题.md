## 习题

<details>
<summary>习题4.3 有以下程序片段，试问汇编后符号L1和L2的值各为多少。

```asm
BUF1 DB 1, 2, 3
BUF2 DW 5, 6, 7
L1 EQU $-BUF2
L2 EQU BUF2-BUF1
```

</summary>

解答：

| 符号 | 值 | 解析 |
| --- | --- | --- |
| L1 | 6 | DW 为 2 字节，BUF2 有三个 DW，所以 BUF2 为 6 字节，$ 为当前地址，所以 L1 为 6|
| L2 | 3 | BUF2-BUF1 为 3，BUF1 有三个 DB，所以 BUF1 为 3 字节，所以 L2 为 3 |

</details>

<details>
<summary>习题4.4 下列语句各为变量分配了多少字节？

```asm
（1）M1 DB 60, ?, 60 DUP ('A')
（2）M2 DB '123'
（3）M3 DB 123
（4）M4 DW 123, 0ABH, 0101B
（5）M5 DD 200, 1 025
（6）M6 DD N3
（7）M7 DW N4
（8）M8 DW N4+2
```

</summary>

解答：

| 语句 | 分配字节数 | 解析 |
| --- | --- | --- |
| `M1 DB 60, ?, 60 DUP（'A'）` | `62` | `60` 为 1 字节，`?` 为 1 字节，`60 DUP ('A')`为 60 个 'A'，所以为 60 字节，加起来为 62 字节 |
| `M2 DB '123'` | `3` | `'123'` 为 3 个字节 |
| `M3 DB 123` | `1` | `123` 为 1 个字节 |
| `M4 DW 123, 0ABH, 0101B` | `6` | `123` 为 2 个字节，`0ABH` 为 2 个字节，`0101B` 为 2 个字节，加起来为 6 个字节 |
| `M5 DD 200, 1 025` | `8` | `200` 为 4 个字节，`1 025` 为 4 个字节，加起来为 8 个字节 |
| `M6 DD N3` | `4` | `N3` 为 4 个字节 |
| `M7 DW N4` | `2` | `N4` 为 2 个字节 |
| `M8 DW N4+2` | `2` | `N4+2` 为 2 个字节 |

</details>

<details>
<summary>习题4.8 编写32位控制台程序，计算result=m*n=x的值。要求提示用户输入32位带符号整数m，n，x，并显示结果</summary>

解答：

```asm
.386
.model flat,stdcall
option casemap:none;

includelib msvcrt.lib
printf PROTO C:ptr sbyte,:VARARG;
scanf PROTO C:ptr sbyte,:VARARG;

.DATA
szMsg byte "请依次输入m，n，x：",0ah,0
scFmt byte "%d%d%d"
szResult byte "result=%d",0ah,0
m dword ?
n dword ?
x dword ?

.CODE
main:
    invoke printf,offset szMsg
    invoke scanf,offset scFmt,offset m,offset n,offset x
    ; m*n - x
    mov eax,m
    imul n
    sub eax,x
    invoke printf,offset szResult,eax
    ret
end main
```

</details>