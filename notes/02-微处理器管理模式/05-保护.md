## 保护

1. **数据访问的保护**
   1. 类型检查
   2. 限长、类型和属性检查
   3. 特权级检查
      1. DPL ≥ MAX(CPL, RPL)，
      2. 即程序只能访问特权级相同或者较低的数据
1. **对程序的保护**
   1. 直接转移的保护
      1. 同一代码段跳转只检查限长
      2. 段间调用或跳转，需要检查限长，特权级CPL和DPL
         1. CPL=DPL，允许跳转和调用
         2. CPL<DPL，禁止
         3. CPL>DPL，此时要检查段描述符的C位。如果C位为1，表示这是一致代码段,允许跳转和调用
      3. 当不是一致代码段时 C=0
         1. 只有CPL=DPL才允许跳转和调用
         2. 还要求RPL ≤ CPL
      4. 如果是一致代码段时 C=1
         1. CPL=DPL和CPL>DPL都允许跳转和调用
            1. 表示DPL的代码段可以由特权级相同或更低的程序来调用或跳转
         2. CPL < DPL不可以调用   
            1. 表示特权级较高的CPL的代码段不可以调用DPL的代码段
   2. 间接转移的保护
      1. 检查jmp和call程序的特权级
      2. call
         1. $DPL_{GATE} \ge \max(CPL, RPL)$
         2. $DPL_{CODE} \le CPL$
         3. 满足上面两个条件执行调用门
         4. if $C_{CODE} = 0$
            1. 提升当前特权级 CPL = DPL_{CODE}
         5. else
            1. CPL不变
      3. jmp
         1. $DPL_{GATE} \ge \max(CPL, RPL)$
         2. $C_{CODE} = 1$ and $DPL_{CODE} \le CPL$
            1. or $C_{CODE} = 0$ and $DPL_{CODE} = CPL$
         3. JMP指令使用调用门不能提升特权级
2. **对输入输出的保护**

- 数据访问的保护；对程序的保护；对输入输出的保护
- 数据访问：DPL ≥ MAX(CPL, RPL)； CPL是当前正在运行的程序的特权级（CS）；DPL是描述符特权级；RPL是请求特权级。
- 段间调用或跳转，需要检查限长，特权级CPL和DPL  <font color=red>这里是指级别 不是指具体的数字</font>
  - CPL = DPL，允许跳转和调用。
  - CPL < DPL，禁止。
  - CPL > DPL，此时要检查段描述符的C位。如果C位为1，表示这是一致代码段,允许跳转和调用。